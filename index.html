<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Academic Management System</title>

    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

    <!-- External CSS -->
    <link rel="stylesheet" href="css/styles.css">
</head>

<body>
    <!-- LOGIN SCREEN -->
    <div id="loginOverlay" class="login-wrapper">
        <div class="login-card">
            <div class="login-header">
                <h2>üéì Academic Management System</h2>
                <p>Please login to continue</p>
            </div>

            <div class="login-tabs">
                <div class="login-tab active" onclick="switchLoginTab('admin')" data-role="admin">Admin</div>
                <div class="login-tab" onclick="switchLoginTab('faculty')" data-role="faculty">Faculty</div>
                <div class="login-tab" onclick="switchLoginTab('student')" data-role="student">Student</div>
            </div>

            <div id="adminLoginForm" class="login-form active">
                <div class="alert alert-error" id="adminLoginError"></div>

                <form onsubmit="handleAdminLogin(event)">
                    <div class="form-group">
                        <label>Admin Email:</label>
                        <input type="email" id="adminEmail" placeholder="admin@college.edu" required>
                    </div>

                    <div class="form-group">
                        <label>Password:</label>
                        <div class="password-wrapper">
                            <input type="password" id="adminPassword" placeholder="Enter password" required>
                            <span class="toggle-password"
                                onclick="togglePasswordVisibility('adminPassword', this)">üëÅÔ∏è</span>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary btn-full">Login as Admin</button>
                </form>
            </div>


            <div id="facultyLoginForm" class="login-form">
                <div class="alert alert-error" id="facultyLoginError"></div>

                <form onsubmit="handleFacultyLogin(event)">
                    <div class="form-group">
                        <label>Faculty ID:</label>
                        <input type="text" id="loginFacultyId" placeholder="Enter Faculty ID" required>
                    </div>

                    <div class="form-group">
                        <label>Password:</label>
                        <div class="password-wrapper">
                            <input type="password" id="loginFacultyPassword" placeholder="Enter password" required>
                            <span class="toggle-password"
                                onclick="togglePasswordVisibility('loginFacultyPassword', this)">üëÅÔ∏è</span>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary btn-full">Login as Faculty</button>
                </form>
            </div>


            <div id="studentLoginForm" class="login-form">
                <div class="alert alert-error" id="studentLoginError" style="display:none;"></div>
                <div class="alert alert-info" id="studentLoginInfo"
                    style="display:none; background: #d4edda; color: #155724; padding: 10px; border-radius: 4px; margin-bottom: 15px;">
                </div>

                <form onsubmit="handleStudentLogin(event)">
                    <div class="form-group">
                        <label>Registration Number (Roll No):</label>
                        <input type="text" id="loginStudentId" placeholder="Enter Reg No (e.g. 22156148040)" required>
                    </div>

                    <div class="form-group">
                        <label>Password:</label>
                        <div class="password-wrapper">
                            <input type="password" id="loginStudentPassword" placeholder="Enter your password">
                            <span class="toggle-password"
                                onclick="togglePasswordVisibility('loginStudentPassword', this)">üëÅÔ∏è</span>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary btn-full">Login as Student</button>

                    <div style="margin-top: 15px; text-align: center;">
                        <a href="#" onclick="handleFirstTimeLogin(event)"
                            style="color: var(--color-primary); font-size: 14px; text-decoration: none; font-weight: bold;">
                            First time logging in? Get Password
                        </a>
                    </div>
                </form>
            </div>

            <!-- MAIN APP CONTAINER -->
            <div class="container" id="mainContainer">
                <div class="navbar">
                    <h1>üéì Academic Management System</h1>
                    <div class="navbar-right">
                        <div class="user-info">
                            <div id="userInfoName" style="font-weight: bold;">Admin User</div>
                            <div id="userInfoRole" class="user-role-badge">ADMIN</div>
                        </div>
                        <button class="btn btn-info btn-small" onclick="openPasswordChangeModal()"
                            id="passwordChangeBtn" style="display: none;">üîê Change Password</button>
                        <div class="offline-indicator">
                            ‚úÖ Online Mode
                        </div>
                        <button class="btn btn-danger btn-small" onclick="handleLogout()">Logout</button>
                    </div>
                </div>

                <!-- ADMIN PANEL -->
                <div id="adminPanel" class="panel">
                    <div class="section">
                        <h2 class="section-title">üìä Dashboard</h2>
                        <div class="dashboard-grid">
                            <div class="stat-card">
                                <h3>Total Students</h3>
                                <div class="value" id="totalStudents">0</div>
                            </div>
                            <div class="stat-card success">
                                <h3>Total Faculty</h3>
                                <div class="value" id="totalFaculty">0</div>
                            </div>
                            <div class="stat-card warning">
                                <h3>Total Classes</h3>
                                <div class="value" id="totalClasses">0</div>
                            </div>
                            <div class="stat-card danger">
                                <h3>Active Years</h3>
                                <div class="value" id="activeYears">0</div>
                            </div>
                        </div>
                    </div>

                    <div class="section">
                        <div class="tabs">
                            <button class="tab-btn active" onclick="switchAdminTab('users')">Students</button>
                            <button class="tab-btn" onclick="switchAdminTab('faculty')">Faculty</button>
                            <button class="tab-btn" onclick="switchAdminTab('classes')">Classes</button>
                            <button class="tab-btn" onclick="switchAdminTab('years')">Years & Semesters</button>
                            <button class="tab-btn" onclick="switchAdminTab('bulkImport')">Bulk Import</button>
                            <button class="tab-btn" onclick="switchAdminTab('attendanceHistory')">Attendance
                                History</button>
                            <button class="tab-btn" onclick="switchAdminTab('internalMarks')">Internal Marks</button>
                            <button class="tab-btn" onclick="switchAdminTab('bulkExport')">Bulk Export</button>
                            <button class="tab-btn" onclick="switchAdminTab('settings')">Settings</button>
                        </div>

                        <!-- Users Tab -->
                        <div id="adminUsers" class="tab-content active">
                            <h2 class="section-title">üë• Students</h2>

                            <!-- Improved Filter Container from Code 2 -->
                            <div class="filter-container">
                                <!-- Branch Filter First (from Code 2) -->
                                <div class="filter-group" id="activeBranchFilterContainer">
                                    <span class="filter-label">üè¢ Filter by Branch:</span>
                                    <select id="classBranchFilter" onchange="loadClasses()" class="branch-select">
                                        <option value="all">All Departments</option>
                                        <option value="Computer Science">Computer Science</option>
                                        <option value="Civil">Civil</option>
                                        <option value="Mechanical">Mechanical</option>
                                        <option value="Electrical">Electrical</option>
                                        <option value="ECE">ECE</option>
                                        <option value="CSE(Cyber Security)">CSE(Cyber Security)</option>
                                        <option value="CSE(Networks)">CSE(Networks)</option>
                                        <option value="Applied Science">Applied Science</option>
                                    </select>
                                </div>

                                <!-- Year Filter (from Code 2) -->
                                <div class="filter-group">
                                    <span class="filter-label">üéì Select Academic Year:</span>
                                    <div class="filter-btn-group" id="yearFilterGroup">
                                        <button class="filter-btn active" onclick="filterStudents('all')">All</button>
                                        <button class="filter-btn" onclick="filterStudents(1)">1st Year</button>
                                        <button class="filter-btn" onclick="filterStudents(2)">2nd Year</button>
                                        <button class="filter-btn" onclick="filterStudents(3)">3rd Year</button>
                                        <button class="filter-btn" onclick="filterStudents(4)">4th Year</button>
                                    </div>
                                </div>

                                <!-- Semester Filter Group (ADDED from Code 2 - was missing in original) -->
                                <div class="filter-group" id="semesterFilterGroup"
                                    style="display:none; margin-top:10px;">
                                    <span class="filter-label">üìÖ Filter by Semester:</span>
                                    <div class="filter-btn-group" id="semesterButtons">
                                        <!-- Semester buttons will be generated here by JavaScript -->
                                    </div>
                                </div>
                            </div>

                            <!-- Select All Banner -->
                            <div id="selectAllBanner" class="selection-prompt" style="display:none;">
                                <span id="selectAllText">You have selected 4 students.</span>
                                <button onclick="selectAllListed()">Select all <span id="selectAllCount">0</span> listed
                                    students</button>
                            </div>

                            <div id="bulkActionContainer" class="bulk-action-bar" style="display:none;">
                                <div class="bulk-control-group">
                                    <strong>üöÄ Increment:</strong>
                                    <button class="btn btn-warning" onclick="promoteFilteredStudents()">
                                        +1 Sem <span class="action-target-text">All Listed</span>
                                    </button>
                                </div>

                                <div class="divider"></div>

                                <div class="bulk-control-group">
                                    <strong>üìÖ Set Exact Sem:</strong>
                                    <select id="bulkSemSelect" class="semester-select">
                                        <option value="1">Sem 1</option>
                                        <option value="2">Sem 2</option>
                                        <option value="3">Sem 3</option>
                                        <option value="4">Sem 4</option>
                                        <option value="5">Sem 5</option>
                                        <option value="6">Sem 6</option>
                                        <option value="7">Sem 7</option>
                                        <option value="8">Sem 8</option>
                                    </select>
                                    <button class="btn btn-info" onclick="setBulkSemester()">Apply to <span
                                            class="action-target-text">All Listed</span></button>
                                </div>

                                <div class="divider"></div>

                                <div class="bulk-control-group">
                                    <strong>üóëÔ∏è Actions:</strong>
                                    <button class="btn btn-danger" onclick="deleteFilteredStudents()">Delete <span
                                            class="action-target-text">Listed</span></button>
                                </div>
                            </div>

                            <div class="table-header">
                                <h3>Student List <span id="studentCount" class="count-badge">(0)</span></h3>
                                <button class="btn btn-primary" onclick="openModal('addUserModal')">+ Add
                                    Student</button>
                            </div>

                            <div class="table-responsive">
                                <table id="usersTable">
                                    <thead>
                                        <tr>
                                            <th><input type="checkbox" id="masterCheckbox" onclick="toggleSelectAll()">
                                            </th>
                                            <th>Roll No</th>
                                            <th>Name</th>
                                            <th>Dept</th>
                                            <th>Year</th>
                                            <th>Sem</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="usersTableBody">
                                        <!-- Students will be loaded here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Faculty Tab -->
                        <div id="adminFaculty" class="tab-content">
                            <h2 class="section-title">üë®‚Äçüè´ Faculty Management</h2>

                            <div class="filter-container">
                                <div class="filter-group">
                                    <span class="filter-label">üè¢ Filter by Branch:</span>
                                    <select id="facultyBranchFilter" onchange="loadFaculty()" class="branch-select">
                                        <option value="all">All Departments</option>
                                        <option value="Computer Science">Computer Science</option>
                                        <option value="Civil">Civil</option>
                                        <option value="Mechanical">Mechanical</option>
                                        <option value="Electrical">Electrical</option>
                                        <option value="ECE">ECE</option>
                                        <option value="CSE(Cyber Security)">CSE(Cyber Security)</option>
                                        <option value="CSE(Networks)">CSE(Networks)</option>
                                        <option value="Applied Science">Applied Science</option>
                                    </select>
                                </div>
                            </div>

                            <div class="action-buttons">
                                <button class="btn btn-primary" onclick="openModal('addFacultyModal')">+ Add
                                    Faculty</button>
                                <button class="btn btn-warning" onclick="openFacultyPasswordResetModal()">üîë Reset
                                    Faculty
                                    Password</button>
                            </div>

                            <div class="table-responsive">
                                <table id="facultyTable">
                                    <thead>
                                        <tr>
                                            <th>Faculty ID</th>
                                            <th>Name</th>
                                            <th>Assigned Classes</th>
                                            <th>Department</th>
                                            <th>Specialization</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="facultyTableBody">
                                        <!-- Faculty will be loaded here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Classes Tab -->
                        <div id="adminClasses" class="tab-content">
                            <h2 class="section-title">üè´ Classes & Subjects</h2>

                            <div class="action-buttons">
                                <button class="btn btn-primary" onclick="openModal('addClassModal')">+ Add
                                    Class</button>
                                <button class="btn btn-success" onclick="openBatchClassModal()">üìÇ Batch Class
                                    Creator</button>
                            </div>

                            <!-- Improved Filter Container from Code 2 -->
                            <div class="filter-container">
                                <!-- Branch Filter (ADDED from Code 2 - was missing in original) -->
                                <div class="filter-group">
                                    <span class="filter-label">üè¢ Filter by Branch:</span>
                                    <select id="classBranchFilter" onchange="loadClasses()" class="branch-select">
                                        <option value="all">All Departments</option>
                                        <option value="Computer Science">Computer Science</option>
                                        <option value="Civil">Civil</option>
                                        <option value="Mechanical">Mechanical</option>
                                        <option value="Electrical">Electrical</option>
                                        <option value="ECE">ECE</option>
                                        <option value="CSE(Cyber Security)">CSE(Cyber Security)</option>
                                        <option value="CSE(Networks)">CSE(Networks)</option>
                                        <option value="Applied Science">Applied Science</option>
                                    </select>
                                </div>

                                <div class="filter-group" id="archiveBranchFilterContainer" style="display:none;">
                                    <span class="filter-label" style="color:#e67e22;">üóÑÔ∏è Filter Archived by
                                        Branch:</span>
                                    <select id="archiveClassBranchFilter" onchange="loadClasses()" class="branch-select"
                                        style="border-color:#e67e22;">
                                        <option value="all">All Departments</option>
                                        <option value="Computer Science">Computer Science</option>
                                        <option value="Civil">Civil</option>
                                        <option value="Mechanical">Mechanical</option>
                                        <option value="Electrical">Electrical</option>
                                        <option value="ECE">ECE</option>
                                        <option value="CSE(Cyber Security)">CSE(Cyber Security)</option>
                                        <option value="CSE(Networks)">CSE(Networks)</option>
                                        <option value="Applied Science">Applied Science</option>
                                    </select>
                                </div>


                                <!-- Year Filter -->
                                <div class="filter-group">
                                    <span class="filter-label">üéì Filter by Year:</span>
                                    <div class="filter-btn-group" id="classYearFilterGroup">
                                        <button class="filter-btn active" onclick="filterClasses('all')">All</button>
                                        <button class="filter-btn" onclick="filterClasses(1)">1st Year</button>
                                        <button class="filter-btn" onclick="filterClasses(2)">2nd Year</button>
                                        <button class="filter-btn" onclick="filterClasses(3)">3rd Year</button>
                                        <button class="filter-btn" onclick="filterClasses(4)">4th Year</button>
                                    </div>
                                </div>

                                <div class="filter-group" id="classSemesterFilterGroup" style="display:none;">
                                    <span class="filter-label">üìÖ Filter by Semester:</span>
                                    <div class="filter-btn-group" id="classSemesterButtons">
                                    </div>
                                </div>
                            </div>

                            <div class="table-responsive">
                                <table id="classesTable">
                                    <thead>
                                        <tr>
                                            <th>Class Code</th>
                                            <th>Course Name</th>
                                            <th>Department</th>
                                            <th>Semester</th>
                                            <th>Faculty</th>
                                            <th>Year</th>
                                            <th>Credits</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="classesTableBody"></tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Years & Semesters Tab -->
                        <div id="adminYears" class="tab-content">
                            <h2 class="section-title">üìÖ Years & Semesters</h2>
                            <button class="btn btn-primary" onclick="openModal('addYearModal')">+ Add Academic
                                Year</button>

                            <div id="yearsContainer">
                                <!-- Years will be loaded here -->
                            </div>

                            <h3 class="subsection-title">Add Custom Semester</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Year:</label>
                                    <input type="number" id="customYearInput" placeholder="e.g., 2024">
                                </div>
                                <div class="form-group">
                                    <label>Semester Number:</label>
                                    <input type="number" id="customSemesterInput" placeholder="e.g., 1-8" min="1"
                                        max="8">
                                </div>
                                <div class="form-group">
                                    <label>&nbsp;</label>
                                    <button class="btn btn-success" onclick="addCustomSemester()">Add Semester</button>
                                </div>
                            </div>
                        </div>

                        <!-- Bulk Import Tab -->
                        <div id="adminBulkImport" class="tab-content">
                            <h2 class="section-title">üì§ Bulk Import</h2>

                            <div class="alert alert-info">
                                ‚ÑπÔ∏è Import multiple records at once from CSV files. Download templates below and fill
                                with
                                your
                                data.
                            </div>

                            <div class="template-section">
                                <h3>üì• Download Templates</h3>
                                <div class="template-buttons">
                                    <button class="btn btn-secondary" onclick="downloadTemplate('students')">üì• Students
                                        Template</button>
                                    <button class="btn btn-secondary" onclick="downloadTemplate('faculty')">üì• Faculty
                                        Template</button>
                                    <button class="btn btn-secondary" onclick="downloadTemplate('classes')">üì• Classes
                                        Template</button>
                                    <button class="btn btn-warning" onclick="downloadCompleteDbTemplate()">üì• Complete
                                        DB
                                        Template</button>
                                </div>
                            </div>

                            <!-- Students Import -->
                            <h3>üìö Import Students (CSV)</h3>
                            <div class="file-upload-area" id="studentUploadArea"
                                onclick="document.getElementById('studentFile').click()">
                                <div class="upload-icon">üìÑ</div>
                                <p><strong>Click to upload or drag & drop</strong></p>
                                <p class="upload-hint">CSV file only</p>
                                <input type="file" id="studentFile" accept=".csv" style="display:none;"
                                    onchange="handleStudentUpload(event)">
                            </div>
                            <div class="import-progress" id="studentProgress">
                                <div>Importing students...</div>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="studentProgressBar" style="width: 0%">0%</div>
                                </div>
                            </div>

                            <!-- Faculty Import -->
                            <h3>üë• Import Faculty (CSV)</h3>
                            <div class="file-upload-area" id="facultyUploadArea"
                                onclick="document.getElementById('facultyFile').click()">
                                <div class="upload-icon">üìÑ</div>
                                <p><strong>Click to upload or drag & drop</strong></p>
                                <p class="upload-hint">CSV file only</p>
                                <input type="file" id="facultyFile" accept=".csv" style="display:none;"
                                    onchange="handleFacultyUpload(event)">
                            </div>
                            <div class="import-progress" id="facultyProgress">
                                <div>Importing faculty...</div>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="facultyProgressBar" style="width: 0%">0%</div>
                                </div>
                            </div>

                            <!-- Classes Import -->
                            <h3>üè´ Import Classes (CSV)</h3>
                            <div class="file-upload-area" id="classesUploadArea"
                                onclick="document.getElementById('classesFile').click()">
                                <div class="upload-icon">üìÑ</div>
                                <p><strong>Click to upload or drag & drop</strong></p>
                                <p class="upload-hint">CSV file only</p>
                                <input type="file" id="classesFile" accept=".csv" style="display:none;"
                                    onchange="handleClassesUpload(event)">
                            </div>
                            <div class="import-progress" id="classesProgress">
                                <div>Importing classes...</div>
                                <div class="progress-bar">
                                    <div class="progress-fill" id="classesProgressBar" style="width: 0%">0%</div>
                                </div>
                            </div>

                            <!-- Complete Database Import -->
                            <div class="complete-import-section">
                                <h3>üîÅ Complete Database Import (ZIP/JSON)</h3>
                                <div class="alert alert-info">
                                    ‚ÑπÔ∏è Import a complete database backup ZIP file or JSON file. This will restore all
                                    data
                                    including attendance records.
                                    <strong>Warning:</strong> This will replace existing data.
                                </div>

                                <div class="file-upload-area" id="completeDbUploadArea"
                                    onclick="document.getElementById('completeDbFile').click()">
                                    <div class="upload-icon">üì¶</div>
                                    <p><strong>Click to upload complete database backup</strong></p>
                                    <p class="upload-hint">ZIP file or JSON backup</p>
                                    <input type="file" id="completeDbFile" accept=".zip,.json,.ZIP,.JSON"
                                        style="display:none;" onchange="handleCompleteDbUpload(event)">
                                </div>

                                <div class="import-progress" id="completeDbProgress">
                                    <div>Importing complete database...</div>
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="completeDbProgressBar" style="width: 0%">0%</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Attendance History Tab -->
                        <div id="adminAttendanceHistory" class="tab-content">
                            <h2 class="section-title">üìä Attendance History Reports</h2>

                            <div class="filter-container">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Select Year:</label>
                                        <select id="adminYearFilter">
                                            <option value="all">All Years</option>
                                            <option value="1">1st Year</option>
                                            <option value="2">2nd Year</option>
                                            <option value="3">3rd Year</option>
                                            <option value="4">4th Year</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label>Select Branch:</label>
                                        <select id="adminBranchFilter">
                                            <option value="all">All Branches</option>
                                            <option value="Computer Science">Computer Science</option>
                                            <option value="Civil">Civil</option>
                                            <option value="Mechanical">Mechanical</option>
                                            <option value="Electrical">Electrical</option>
                                            <option value="ECE">ECE</option>
                                            <option value="CSE(Cyber Security)">CSE(Cyber Security)</option>
                                            <option value="CSE(Networks)">CSE(Networks)</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label>Select Semester:</label>
                                        <select id="adminSemesterFilter">
                                            <option value="all">All Semesters</option>
                                            <option value="1">Semester 1</option>
                                            <option value="2">Semester 2</option>
                                            <option value="3">Semester 3</option>
                                            <option value="4">Semester 4</option>
                                            <option value="5">Semester 5</option>
                                            <option value="6">Semester 6</option>
                                            <option value="7">Semester 7</option>
                                            <option value="8">Semester 8</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Select Class:</label>
                                        <select id="adminClassFilter">
                                            <option value="all">All Classes</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label>Date Filter:</label>
                                        <div class="radio-group">
                                            <label>
                                                <input type="radio" name="dateFilterType" value="all" checked
                                                    onchange="toggleDateRange()">
                                                <span>All Records</span>
                                            </label>
                                            <label>
                                                <input type="radio" name="dateFilterType" value="range"
                                                    onchange="toggleDateRange()">
                                                <span>Date Range</span>
                                            </label>
                                        </div>
                                        <div id="dateRangeInputs" class="date-range-inputs" style="display: none;">
                                            <input type="date" id="adminDateFrom">
                                            <span class="range-separator">to</span>
                                            <input type="date" id="adminDateTo">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label>Status Filter:</label>
                                        <select id="adminStatusFilter">
                                            <option value="all">All Status</option>
                                            <option value="present">Present Only</option>
                                            <option value="absent">Absent Only</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Sort By:</label>
                                        <select id="adminSortBy">
                                            <option value="percentage_desc">Percentage (High to Low)</option>
                                            <option value="percentage_asc">Percentage (Low to High)</option>
                                            <option value="rollno_asc">Roll No (Ascending)</option>
                                            <option value="rollno_desc">Roll No (Descending)</option>
                                            <option value="name_asc">Name (A-Z)</option>
                                            <option value="name_desc">Name (Z-A)</option>
                                        </select>
                                    </div>

                                    <div class="form-group action-buttons">
                                        <label>&nbsp;</label>
                                        <button class="btn btn-primary" onclick="loadAdminAttendanceHistory()">üìä Load
                                            Attendance</button>
                                        <button class="btn btn-info" onclick="loadAdminAttendanceHistory()">üîÑ
                                            Refresh</button>
                                        <button class="btn btn-secondary" onclick="clearAdminFilters()">üßπ Clear
                                            Filters</button>
                                    </div>
                                </div>
                            </div>

                            <div class="table-header">
                                <h3>Attendance Records <span id="adminRecordCount" class="count-badge">(0)</span></h3>
                                <div class="export-buttons">
                                    <button class="btn btn-success" onclick="exportAdminHistory('csv')">üì• Export
                                        CSV</button>
                                    <button class="btn btn-danger" onclick="exportAdminHistory('pdf')">üì• Export
                                        PDF</button>
                                    <button class="btn btn-primary" onclick="exportAdminHistory('excel')">üì• Export
                                        Excel</button>
                                    <button class="btn btn-warning" onclick="exportAdminHistory('json')">üì• Export
                                        JSON</button>
                                </div>
                            </div>

                            <!-- Year-wise Attendance Summary Section -->
                            <div id="yearWiseAttendanceSection" class="summary-section">
                                <h3>üìà Year-wise Attendance Summary</h3>
                                <div id="yearWiseAttendanceSummary">
                                    <!-- Will be populated dynamically -->
                                </div>
                            </div>

                            <div id="adminAttendanceTableContainer" class="table-responsive">
                                <table id="adminAttendanceTable">
                                    <thead>
                                        <tr>
                                            <th>Roll No</th>
                                            <th>Student Name</th>
                                            <th>Department</th>
                                            <th>Year</th>
                                            <th>Semester</th>
                                            <th>Class</th>
                                            <th>Total Classes</th>
                                            <th>Present</th>
                                            <th>Absent</th>
                                            <th>Attendance %</th>
                                        </tr>
                                    </thead>
                                    <tbody id="adminAttendanceBody">
                                        <!-- Records will be loaded here -->
                                    </tbody>
                                </table>
                            </div>

                            <div id="adminAttendanceStats" class="stats-section">
                                <h4>üìà Statistics</h4>
                                <div class="dashboard-grid">
                                    <div class="stat-card"
                                        style="background: linear-gradient(135deg, #27ae60, #229954);">
                                        <h3>Total Students</h3>
                                        <div class="value" id="statTotalRecords">0</div>
                                    </div>
                                    <div class="stat-card"
                                        style="background: linear-gradient(135deg, #3498db, #2980b9);">
                                        <h3>Average Attendance %</h3>
                                        <div class="value" id="statAvgPercentage">0%</div>
                                    </div>
                                    <div class="stat-card"
                                        style="background: linear-gradient(135deg, #f39c12, #d68910);">
                                        <h3>Above 75%</h3>
                                        <div class="value" id="statAbove75">0</div>
                                    </div>
                                    <div class="stat-card"
                                        style="background: linear-gradient(135deg, #e74c3c, #c0392b);">
                                        <h3>Below 75%</h3>
                                        <div class="value" id="statBelow75">0</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Internal Marks Tab -->
                        <div id="adminInternalMarks" class="tab-content">
                            <h2 class="section-title">üìä Internal Marks Reports</h2>

                            <div class="filter-container">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Select Year:</label>
                                        <select id="adminMarksYearFilter">
                                            <option value="all">All Years</option>
                                            <option value="1">1st Year</option>
                                            <option value="2">2nd Year</option>
                                            <option value="3">3rd Year</option>
                                            <option value="4">4th Year</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label>Select Branch:</label>
                                        <select id="adminMarksBranchFilter">
                                            <option value="all">All Branches</option>
                                            <option value="Computer Science">Computer Science</option>
                                            <option value="Civil">Civil</option>
                                            <option value="Mechanical">Mechanical</option>
                                            <option value="Electrical">Electrical</option>
                                            <option value="ECE">ECE</option>
                                            <option value="CSE(Cyber Security)">CSE(Cyber Security)</option>
                                            <option value="CSE(Networks)">CSE(Networks)</option>
                                            <option value="Applied Science">Applied Science</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label>Select Semester:</label>
                                        <select id="adminMarksSemesterFilter">
                                            <option value="all">All Semesters</option>
                                            <option value="1">Semester 1</option>
                                            <option value="2">Semester 2</option>
                                            <option value="3">Semester 3</option>
                                            <option value="4">Semester 4</option>
                                            <option value="5">Semester 5</option>
                                            <option value="6">Semester 6</option>
                                            <option value="7">Semester 7</option>
                                            <option value="8">Semester 8</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Select Class:</label>
                                        <select id="adminMarksClassFilter">
                                            <option value="all">All Classes</option>
                                        </select>
                                    </div>

                                    <div class="form-group">
                                        <label>Sort By:</label>
                                        <select id="adminMarksSortBy">
                                            <option value="total_desc">Total Marks (High to Low)</option>
                                            <option value="total_asc">Total Marks (Low to High)</option>
                                            <option value="rollno_asc">Roll No (Ascending)</option>
                                            <option value="name_asc">Name (A-Z)</option>
                                        </select>
                                    </div>

                                    <div class="form-group action-buttons">
                                        <label>&nbsp;</label>
                                        <button class="btn btn-primary" onclick="loadAdminMarksTable()">üìä Load
                                            Marks</button>
                                        <button class="btn btn-info" onclick="loadAdminMarksTable()">üîÑ Refresh</button>
                                    </div>
                                </div>
                            </div>

                            <div class="table-header">
                                <h3>Marks Records <span id="adminMarksCount" class="count-badge">(0)</span></h3>
                                <div class="export-buttons">
                                    <button class="btn btn-success" onclick="exportInternalMarks('csv')">üì• Export
                                        CSV</button>
                                    <button class="btn btn-danger" onclick="exportInternalMarks('pdf')">üì• Export
                                        PDF</button>
                                    <button class="btn btn-primary" onclick="exportInternalMarks('excel')">üì• Export
                                        Excel</button>
                                    <button class="btn btn-warning" onclick="exportInternalMarks('json')">üì• Export
                                        JSON</button>
                                </div>
                            </div>

                            <div id="adminMarksTableContainer" class="table-responsive">
                                <table id="adminMarksTable">
                                    <thead>
                                        <tr>
                                            <th>Roll No</th>
                                            <th>Name</th>
                                            <th>Department</th>
                                            <th>Mid-Sem</th>
                                            <th>Assignment</th>
                                            <th>Attendance</th>
                                            <th>Total</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="7" style="text-align:center; padding: 20px;">Select filters and
                                                click
                                                Load Marks</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Bulk Export Tab -->
                        <div id="adminBulkExport" class="tab-content">
                            <h2 class="section-title">üì§ Data Export & Backup</h2>

                            <div class="dashboard-grid" style="margin-bottom: 25px;">
                                <div class="stat-card"
                                    style="background: linear-gradient(135deg, #6c5ce7, #a29bfe); padding: 15px;">
                                    <h3 style="font-size: 12px; margin-bottom: 5px;">Total Students</h3>
                                    <div class="value" id="exportStudentCount1" style="font-size: 24px;">0</div>
                                    <small style="opacity: 0.8; font-size: 11px;">Available for export</small>
                                </div>
                                <div class="stat-card"
                                    style="background: linear-gradient(135deg, #00cec9, #81ecec); padding: 15px;">
                                    <h3 style="font-size: 12px; margin-bottom: 5px;">Total Faculty</h3>
                                    <div class="value" id="exportFacultyCount1" style="font-size: 24px;">0</div>
                                    <small style="opacity: 0.8; font-size: 11px;">Registered members</small>
                                </div>
                                <div class="stat-card"
                                    style="background: linear-gradient(135deg, #fdcb6e, #ffeaa7); color: #d35400; padding: 15px;">
                                    <h3 style="font-size: 12px; margin-bottom: 5px; color: #d35400;">Total Classes</h3>
                                    <div class="value" id="exportClassCount1" style="font-size: 24px;">0</div>
                                    <small style="opacity: 0.8; font-size: 11px;">Active subjects</small>
                                </div>
                            </div>

                            <div class="filter-container"
                                style="background: white; border: 1px solid #ddd; padding: 25px;">
                                <h3
                                    style="margin-top:0; border-bottom: 1px solid #eee; padding-bottom: 10px; margin-bottom: 15px;">
                                    ‚úÖ Select Data to Export
                                </h3>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label style="font-weight:bold; cursor:pointer;">
                                            <input type="checkbox" id="expStudents" checked> üë• Students
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label style="font-weight:bold; cursor:pointer;">
                                            <input type="checkbox" id="expFaculty" checked> üë®‚Äçüè´ Faculty
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label style="font-weight:bold; cursor:pointer;">
                                            <input type="checkbox" id="expClasses" checked> üè´ Classes
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label style="font-weight:bold; cursor:pointer;">
                                            <input type="checkbox" id="expYears" checked> üìÖ Academic Years
                                        </label>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label style="font-weight:bold; cursor:pointer;">
                                            <input type="checkbox" id="expAttendance"> üìä Attendance Records
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label style="font-weight:bold; cursor:pointer;">
                                            <input type="checkbox" id="expInternalMarks"> üìù Internal Marks
                                        </label>
                                    </div>
                                    <div class="form-group">
                                        <label style="font-weight:bold; cursor:pointer;">
                                            <input type="checkbox" id="expSettings" checked> ‚öôÔ∏è Settings
                                        </label>
                                    </div>
                                </div>

                                <div style="margin-top:10px;">
                                    <button class="btn btn-small btn-secondary"
                                        onclick="toggleExportCheckboxes(true)">Select
                                        All</button>
                                    <button class="btn btn-small btn-secondary"
                                        onclick="toggleExportCheckboxes(false)">Deselect
                                        All</button>
                                </div>
                            </div>

                            <div class="filter-container"
                                style="background: #f8f9fa; border: 1px solid #ddd; padding: 25px; margin-top:20px;">
                                <div class="action-buttons" style="justify-content: flex-start; gap: 20px;">
                                    <button class="btn btn-primary" onclick="handleCustomExport('csv')">
                                        üì• Export as CSV (ZIP)
                                    </button>

                                    <button class="btn btn-warning" onclick="handleCustomExport('json')">
                                        üíæ Export as JSON (Backup)
                                    </button>
                                </div>
                            </div>

                            <!-- Export Statistics - Fixed Position -->
                            <div class="export-stats"
                                style="margin-top: 30px; padding: 25px; background: #f8f9fa; border-radius: 8px; border: 1px solid #ddd;">
                                <h3
                                    style="margin-top: 0; color: #2c3e50; border-bottom: 1px solid #ddd; padding-bottom: 10px;">
                                    üìä Export Statistics</h3>
                                <div class="stats-grid"
                                    style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-top: 15px;">
                                    <div class="stat-item">
                                        <h4 style="margin: 0 0 10px 0; color: #34495e; font-size: 14px;">Students</h4>
                                        <div id="exportStudentCount2" class="stat-number"
                                            style="font-size: 32px; font-weight: bold; color: #6c5ce7;">0</div>
                                        <p style="margin: 5px 0 0 0; color: #7f8c8d; font-size: 12px;">Total students
                                            available
                                            for export</p>
                                    </div>

                                    <div class="stat-item">
                                        <h4 style="margin: 0 0 10px 0; color: #34495e; font-size: 14px;">Faculty</h4>
                                        <div id="exportFacultyCount2" class="stat-number"
                                            style="font-size: 32px; font-weight: bold; color: #00cec9;">0</div>
                                        <p style="margin: 5px 0 0 0; color: #7f8c8d; font-size: 12px;">Total faculty
                                            available
                                            for export</p>
                                    </div>

                                    <div class="stat-item">
                                        <h4 style="margin: 0 0 10px 0; color: #34495e; font-size: 14px;">Classes</h4>
                                        <div id="exportClassCount2" class="stat-number"
                                            style="font-size: 32px; font-weight: bold; color: #f39c12;">0</div>
                                        <p style="margin: 5px 0 0 0; color: #7f8c8d; font-size: 12px;">Total classes
                                            available
                                            for export</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Settings Tab -->
                        <div id="adminSettings" class="tab-content">
                            <h2 class="section-title">‚öôÔ∏è System Settings</h2>

                            <div class="dashboard-grid"
                                style="grid-template-columns: 2fr 1fr; gap: 20px; display: grid;">

                                <div class="filter-container"
                                    style="background: white; border: 1px solid #ddd; padding: 30px; height: 100%;">
                                    <h3
                                        style="margin-top: 0; color: #2c3e50; border-bottom: 2px solid #f0f0f0; padding-bottom: 15px; margin-bottom: 25px;">
                                        üìù General Configuration
                                    </h3>

                                    <form onsubmit="saveSettings(event)">
                                        <div class="form-group" style="margin-bottom: 25px;">
                                            <label style="font-weight: bold; color: #34495e; font-size: 14px;">College /
                                                Institution
                                                Name</label>
                                            <input type="text" id="collegeName"
                                                value="Government Engineering College Kaimur"
                                                style="border: 2px solid #bdc3c7; padding: 12px; border-radius: 6px; font-size: 15px; margin-top: 8px;">
                                            <small style="color: #7f8c8d; display: block; margin-top: 5px;">
                                                This name will appear on all exported reports and headers.
                                            </small>
                                        </div>

                                        <div class="form-group" style="margin-bottom: 30px;">
                                            <label style="font-weight: bold; color: #34495e; font-size: 14px;">Minimum
                                                Attendance
                                                Threshold (%)</label>
                                            <input type="number" id="minAttendance" value="75" min="0" max="100"
                                                style="border: 2px solid #bdc3c7; padding: 12px; border-radius: 6px; font-size: 15px; width: 120px; margin-top: 8px;">
                                            <small style="color: #7f8c8d; display: block; margin-top: 5px;">
                                                Students below this percentage will be highlighted in red (Shortage).
                                            </small>
                                        </div>

                                        <div style="padding-top: 20px; border-top: 1px solid #eee;">
                                            <button type="submit" class="btn btn-success"
                                                style="padding: 12px 30px; font-size: 15px; display: flex; align-items: center; gap: 8px;">
                                                üíæ Save Configuration
                                            </button>
                                        </div>
                                    </form>
                                </div>

                                <div style="display: flex; flex-direction: column; gap: 20px;">

                                    <div class="filter-container"
                                        style="background: #e8f4f8; border-left: 5px solid var(--color-info); padding: 20px; margin-bottom: 0;">
                                        <h4 style="margin-top: 0; color: var(--color-info); font-size: 16px;">üì¶ System
                                            Backup
                                        </h4>
                                        <p style="font-size: 13px; color: #555; margin-bottom: 15px; line-height: 1.4;">
                                            Download a complete backup of Students, Faculty, Classes, and Attendance
                                            data.
                                        </p>
                                        <button type="button" class="btn btn-info btn-full"
                                            onclick="exportCompleteDatabase()">
                                            üì• Export Full Backup
                                        </button>
                                    </div>

                                    <div class="filter-container"
                                        style="background: #fff5f5; border-left: 5px solid var(--color-danger); padding: 20px; margin-bottom: 0;">
                                        <h4 style="margin-top: 0; color: var(--color-danger); font-size: 16px;">‚ö†Ô∏è
                                            Danger Zone
                                        </h4>
                                        <p style="font-size: 13px; color: #555; margin-bottom: 15px; line-height: 1.4;">
                                            Irreversible actions. Use this to reset student data for a new academic
                                            year.
                                        </p>
                                        <button type="button" class="btn btn-danger btn-full"
                                            onclick="clearAllStudents()">
                                            üóëÔ∏è Delete All Students
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- FACULTY PANEL -->
                <div id="facultyPanel" class="panel">
                    <div class="section">
                        <div class="tabs">
                            <button class="tab-btn active" onclick="switchFacultyTab('mark', event)">Mark
                                Attendance</button>
                            <button class="tab-btn" onclick="switchFacultyTab('history', event)">Date-wise
                                History</button>
                            <button class="tab-btn" onclick="switchFacultyTab('report', event)">Report</button>
                            <button class="tab-btn" onclick="switchFacultyTab('marks', event)">Internal Marks</button>
                        </div>

                        <!-- Mark Attendance Tab -->
                        <div id="facultyMark" class="tab-content active">
                            <h2 class="section-title">‚úÖ Mark Attendance (Multi-Session Support)</h2>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Select Class:</label>
                                    <select id="facultyClassSelect" onchange="loadClassStudents()">
                                        <option value="">-- Select a class --</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Date:</label>
                                    <input type="date" id="attendanceDate">
                                </div>
                                <div class="form-group">
                                    <label>Session:</label>
                                    <select id="attendanceSession">
                                        <option value="1">Session 1</option>
                                        <option value="2">Session 2</option>
                                        <option value="3">Session 3</option>
                                        <option value="4">Session 4</option>
                                        <option value="5">Session 5</option>
                                    </select>
                                </div>
                            </div>

                            <div class="action-buttons">
                                <button class="btn btn-secondary" onclick="openBulkAttendanceModal()">üìÇ Bulk
                                    Upload</button>
                                <button class="btn btn-info" onclick="downloadAttendanceReport()">üì• Download Report
                                    (CSV)</button>
                                <button class="btn btn-warning" id="multiSessionBtn" style="display:none;">üìÖ Mark
                                    Multiple
                                    Sessions</button>
                            </div>

                            <!-- Add Student/Batch to Session Logic -->
                            <div class="extra-students-section">
                                <h4>‚ûï Add Extra Students (Electives/Backlogs)</h4>

                                <div class="add-single-student">
                                    <input type="text" id="addStudentToSessionInput"
                                        placeholder="Enter Roll No (e.g. 22156...)">
                                    <button class="btn btn-info" onclick="addStudentToSession()">Add Single
                                        Student</button>
                                </div>

                                <div class="add-batch-section">
                                    <select id="addBatchBranch">
                                        <option value="">-- Select Branch --</option>
                                        <option value="Computer Science">Computer Science</option>
                                        <option value="Civil">Civil</option>
                                        <option value="Mechanical">Mechanical</option>
                                        <option value="Electrical">Electrical</option>
                                        <option value="ECE">ECE</option>
                                        <option value="CSE(Cyber Security)">CSE(Cyber Security)</option>
                                        <option value="CSE(Networks)">CSE(Networks)</option>
                                        <option value="Applied Science">Applied Science</option>
                                    </select>
                                    <select id="addBatchSem">
                                        <option value="">-- Sem --</option>
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                        <option value="6">6</option>
                                        <option value="7">7</option>
                                        <option value="8">8</option>
                                    </select>
                                    <button class="btn btn-warning" onclick="addBatchToSession()">Add Whole
                                        Batch</button>
                                </div>
                            </div>

                            <div id="studentGridContainer" style="display:none;">
                                <div id="studentGrid" class="student-grid"></div>
                                <div class="action-buttons">
                                    <button class="btn btn-success" onclick="submitAttendance()">‚úîÔ∏è Submit Attendance
                                        for
                                        Session <span id="currentSessionDisplay">1</span></button>
                                    <button class="btn btn-secondary" onclick="resetAttendance()">üîÑ Reset</button>
                                </div>
                            </div>
                        </div>

                        <!-- Date-wise History Tab -->
                        <div id="facultyHistory" class="tab-content">
                            <h2 class="section-title">üìÖ Attendance History (Multi-Session)</h2>
                            <div class="table-header">
                                <p class="description">Select a date to view or edit attendance for the selected class.
                                </p>
                                <button class="btn btn-success" onclick="downloadHistoryCSV()">üíæ Download History
                                    (CSV)</button>
                                <button class="btn btn-info" onclick="downloadSubjectAttendanceReport()">üìä Download
                                    Subject
                                    Attendance Report</button>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label>Select Class:</label>
                                    <select id="historyClassSelect" onchange="loadAttendanceHistory()">
                                        <option value="">-- Select a class --</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Filter Date (Optional):</label>
                                    <input type="date" id="historyDateFilter" onchange="loadAttendanceHistory()">
                                </div>
                            </div>

                            <div id="historyList" class="table-responsive"></div>
                        </div>

                        <!-- Report Tab -->
                        <div id="facultyReport" class="tab-content">
                            <h2 class="section-title">üìà Year-wise Attendance Report</h2>
                            <div class="year-filter" id="yearFilter"></div>
                            <div class="table-responsive">
                                <table id="yearWiseAttendanceTable">
                                    <thead>
                                        <tr>
                                            <th>Year</th>
                                            <th>Subject Details</th>
                                            <th style="text-align:center;">Total Students</th>
                                            <th style="text-align:center;">Classes Held</th>
                                            <th style="text-align:center;">Avg Strength</th>
                                            <th style="text-align:center;">Action</th>
                                        </tr>
                                    </thead>
                                    <tbody id="yearWiseAttendanceBody">
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Internal Marks Tab -->
                        <div id="facultyMarks" class="tab-content">
                            <h2 class="section-title">üìù Update Internal Marks</h2>

                            <div class="form-row">
                                <div class="form-group">
                                    <label>Select Class:</label>
                                    <select id="facultyMarksClassSelect" onchange="loadFacultyMarksTable()">
                                        <option value="">-- Select a class --</option>
                                    </select>
                                </div>
                            </div>

                            <div class="filter-container"
                                style="background: #e8f4f8; border-left: 4px solid var(--color-info); padding: 20px;">
                                <div
                                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                                    <div>
                                        <h4 style="margin: 0; color: var(--color-dark); font-size: 16px;">‚öôÔ∏è Max Marks
                                            Structure
                                        </h4>
                                        <small style="color: #666;">Define the maximum scores for this subject.</small>
                                    </div>
                                    <button class="btn btn-primary btn-small" onclick="saveMaxMarksConfiguration()"
                                        title="Save these settings for this subject">
                                        üíæ Save Structure
                                    </button>
                                </div>

                                <div class="form-row" style="margin-bottom: 0;">
                                    <div class="form-group">
                                        <label style="font-weight: bold;">Max Mid-Sem:</label>
                                        <input type="number" id="maxMidSem" value="20" min="0"
                                            style="border: 2px solid #b3e5fc;" onchange="recalculateAllTotals()">
                                    </div>
                                    <div class="form-group">
                                        <label style="font-weight: bold;">Max Assignment:</label>
                                        <input type="number" id="maxAssign" value="10" min="0"
                                            style="border: 2px solid #b3e5fc;" onchange="recalculateAllTotals()">
                                    </div>
                                    <div class="form-group">
                                        <label style="font-weight: bold;">Max Attendance:</label>
                                        <input type="number" id="maxAtt" value="10" min="0"
                                            style="border: 2px solid #b3e5fc;" onchange="recalculateAllTotals()">
                                    </div>
                                </div>
                            </div>

                            <div id="marksEntryContainer" style="display:none; margin-top:20px;">
                                <div class="action-buttons">
                                    <button class="btn btn-success" onclick="saveInternalMarks()">üíæ Save All
                                        Marks</button>
                                    <button class="btn btn-danger" onclick="downloadFacultyMarksReport()">üì• Download
                                        Report
                                        (PDF)</button>
                                    <button class="btn btn-warning" onclick="resetAllMarks()">üîÑ Reset All</button>
                                </div>

                                <div class="table-responsive" style="margin-top: 15px;">
                                    <table class="marks-table">
                                        <thead>
                                            <tr>
                                                <th>Roll No</th>
                                                <th>Name</th>
                                                <th>Mid-Sem</th>
                                                <th>Assignment</th>
                                                <th>Attendance</th>
                                                <th>Total</th>
                                            </tr>
                                        </thead>
                                        <tbody id="facultyMarksBody">
                                            <!-- Marks data will be populated here -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- STUDENT PANEL -->
                <div id="studentPanel" class="panel">
                    <div class="section">
                        <h2 class="section-title">üë§ Student Profile</h2>
                        <div class="profile-card">
                            <div class="profile-info">
                                <h3 id="studentNameDisplay">Student Name</h3>
                                <p id="studentRollDisplay" class="roll-no">Roll No: -</p>
                            </div>
                            <div class="profile-details">
                                <p><strong>Email:</strong> <span id="studentEmailDisplay">-</span></p>
                                <p><strong>Department:</strong> <span id="studentDeptDisplay">-</span></p>
                                <p><strong>Semester:</strong> <span id="studentSemDisplay">-</span></p>
                                <p><strong>Year:</strong> <span id="studentYearDisplay">-</span></p>
                            </div>
                        </div>
                    </div>

                    <div class="section">
                        <h2 class="section-title">üìö My Attendance</h2>
                        <div class="table-responsive">
                            <table id="studentAttendanceTable">
                                <thead>
                                    <tr>
                                        <th>Course</th>
                                        <th>Faculty</th>
                                        <th>Total Classes (Sessions)</th>
                                        <th>Attended</th>
                                        <th>Percentage</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="studentAttendanceBody">
                                    <tr>
                                        <td colspan="6" class="no-data">No attendance records found yet.</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- ================ MODALS ================ -->

                <!-- Faculty Profile Modal -->
                <div id="facultyProfileModal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            Faculty Profile
                            <button class="close-btn" onclick="closeModal('facultyProfileModal')">&times;</button>
                        </div>
                        <div id="facultyProfileContent"></div>
                        <div class="modal-footer">
                            <button class="btn btn-info" id="btnEditFacultyClasses">‚úèÔ∏è Edit Profile & Classes</button>
                            <button class="btn btn-secondary" onclick="closeModal('facultyProfileModal')">Close</button>
                        </div>
                    </div>
                </div>

                <!-- Add Student Modal -->
                <div id="addUserModal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            Add Student
                            <button class="close-btn" onclick="closeModal('addUserModal')">&times;</button>
                        </div>
                        <form onsubmit="addStudent(event)">
                            <div class="form-group">
                                <label>Roll No:</label>
                                <input type="text" id="studentRollNo" oninput="autoFillStudentDetails()" required>
                                <small class="input-hint">Enter Roll No (e.g. 22156...) to auto-fill details</small>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>First Name:</label>
                                    <input type="text" id="studentFirstName" required>
                                </div>
                                <div class="form-group">
                                    <label>Last Name:</label>
                                    <input type="text" id="studentLastName" required>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Email:</label>
                                <input type="email" id="studentEmail" required>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Department:</label>
                                    <select id="studentDept" required>
                                        <option value="">-- Select --</option>
                                        <option value="Computer Science">Computer Science</option>
                                        <option value="Civil">Civil</option>
                                        <option value="Mechanical">Mechanical</option>
                                        <option value="Electrical">Electrical</option>
                                        <option value="ECE">ECE</option>
                                        <option value="CSE(Cyber Security)">CSE(Cyber Security)</option>
                                        <option value="CSE(Networks)">CSE(Networks)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Year:</label>
                                    <input type="number" id="studentYear" required>
                                </div>
                                <div class="form-group">
                                    <label>Semester:</label>
                                    <select id="studentSemester" required>
                                        <option value="">-- Select --</option>
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                        <option value="6">6</option>
                                        <option value="7">7</option>
                                        <option value="8">8</option>
                                    </select>
                                </div>
                            </div>
                            <button type="submit" class="btn btn-success">Add Student</button>
                        </form>
                    </div>
                </div>

                <!-- Add Faculty Modal -->
                <div id="addFacultyModal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            Add Faculty
                            <button class="close-btn" onclick="closeModal('addFacultyModal')">&times;</button>
                        </div>
                        <form onsubmit="addFaculty(event)">
                            <div class="form-group">
                                <label>Faculty ID:</label>
                                <input type="text" id="facultyId" required>
                            </div>
                            <div class="form-group">
                                <label>Password:</label>
                                <input type="password" id="facultyPassword" placeholder="Set login password" required>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>First Name:</label>
                                    <input type="text" id="facultyFirstName" required>
                                </div>
                                <div class="form-group">
                                    <label>Last Name:</label>
                                    <input type="text" id="facultyLastName" required>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="optional-label">Email</label>
                                <input type="email" id="facultyEmail" placeholder="Optional field">
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Department:</label>
                                    <select id="facultyDept" required>
                                        <option value="">-- Select --</option>
                                        <option value="Computer Science">Computer Science</option>
                                        <option value="Civil">Civil</option>
                                        <option value="Mechanical">Mechanical</option>
                                        <option value="Electrical">Electrical</option>
                                        <option value="ECE">ECE</option>
                                        <option value="CSE(Cyber Security)">CSE(Cyber Security)</option>
                                        <option value="CSE(Networks)">CSE(Networks)</option>
                                        <option value="Applied Science">Applied Science</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="optional-label">Specialization</label>
                                    <input type="text" id="facultySpecial" placeholder="Optional field">
                                </div>
                            </div>
                            <button type="submit" class="btn btn-success">Add Faculty</button>
                        </form>
                    </div>
                </div>

                <!-- Edit Faculty Modal -->
                <div id="editFacultyModal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            Edit Faculty
                            <button class="close-btn" onclick="closeModal('editFacultyModal')">&times;</button>
                        </div>
                        <form onsubmit="updateFaculty(event)">
                            <input type="hidden" id="editFacultyIdKey">
                            <div class="form-group">
                                <label>Faculty ID:</label>
                                <input type="text" id="editFacultyId" required>
                            </div>
                            <div class="form-group">
                                <label>Password (Leave blank to keep current):</label>
                                <input type="password" id="editFacultyPassword"
                                    placeholder="Enter new password to change">
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>First Name:</label>
                                    <input type="text" id="editFacultyFirstName" required>
                                </div>
                                <div class="form-group">
                                    <label>Last Name:</label>
                                    <input type="text" id="editFacultyLastName" required>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Email:</label>
                                <input type="email" id="editFacultyEmail">
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Department:</label>
                                    <select id="editFacultyDept" required>
                                        <option value="">-- Select --</option>
                                        <option value="Computer Science">Computer Science</option>
                                        <option value="Civil">Civil</option>
                                        <option value="Mechanical">Mechanical</option>
                                        <option value="Electrical">Electrical</option>
                                        <option value="ECE">ECE</option>
                                        <option value="CSE(Cyber Security)">CSE(Cyber Security)</option>
                                        <option value="CSE(Networks)">CSE(Networks)</option>
                                        <option value="Applied Science">Applied Science</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Specialization:</label>
                                    <input type="text" id="editFacultySpecial">
                                </div>
                            </div>

                            <h4 class="modal-subtitle">Assign Classes</h4>
                            <p class="modal-description">Select classes to assign to this faculty member.</p>
                            <div class="class-assignment-grid" id="editFacultyClassesList"></div>

                            <div class="modal-footer">
                                <button type="submit" class="btn btn-success">Update Faculty</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Add Class Modal -->
                <div id="addClassModal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            Add Class
                            <button class="close-btn" onclick="closeModal('addClassModal')">&times;</button>
                        </div>
                        <form onsubmit="addClass(event)">
                            <div class="form-group">
                                <label>Class Code:</label>
                                <input type="text" id="classCode" required>
                            </div>
                            <div class="form-group">
                                <label>Course Name:</label>
                                <input type="text" id="courseName" required>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Department (Hold Ctrl/Cmd to select multiple):</label>
                                    <select id="classDept" required multiple style="height: 100px;">
                                        <option value="Computer Science">Computer Science</option>
                                        <option value="Civil">Civil</option>
                                        <option value="Mechanical">Mechanical</option>
                                        <option value="Electrical">Electrical</option>
                                        <option value="ECE">ECE</option>
                                        <option value="CSE(Cyber Security)">CSE(Cyber Security)</option>
                                        <option value="CSE(Networks)">CSE(Networks)</option>
                                        <option value="Applied Science">Applied Science</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Semester:</label>
                                    <input type="number" id="classSemester" required>
                                </div>
                                <div class="form-group">
                                    <label>Year:</label>
                                    <input type="number" id="classYear" required>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Faculty:</label>
                                    <select id="classFaculty" required></select>
                                </div>
                                <div class="form-group">
                                    <label>Credits:</label>
                                    <input type="number" id="classCredits" value="3">
                                </div>
                            </div>
                            <button type="submit" class="btn btn-success">Add Class</button>
                        </form>
                    </div>
                </div>

                <!-- Edit Class Modal -->
                <div id="editClassModal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            Edit Class
                            <button class="close-btn" onclick="closeModal('editClassModal')">&times;</button>
                        </div>
                        <form onsubmit="updateClass(event)">
                            <input type="hidden" id="editClassIdKey">
                            <div class="form-group">
                                <label>Class Code:</label>
                                <input type="text" id="editClassCode" required>
                            </div>
                            <div class="form-group">
                                <label>Course Name:</label>
                                <input type="text" id="editCourseName" required>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Department (Hold Ctrl/Cmd to select multiple):</label>
                                    <select id="editClassDept" required multiple style="height: 100px;">
                                        <option value="Computer Science">Computer Science</option>
                                        <option value="Civil">Civil</option>
                                        <option value="Mechanical">Mechanical</option>
                                        <option value="Electrical">Electrical</option>
                                        <option value="ECE">ECE</option>
                                        <option value="CSE(Cyber Security)">CSE(Cyber Security)</option>
                                        <option value="CSE(Networks)">CSE(Networks)</option>
                                        <option value="Applied Science">Applied Science</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Semester:</label>
                                    <input type="number" id="editClassSemester" required>
                                </div>
                                <div class="form-group">
                                    <label>Year:</label>
                                    <input type="number" id="editClassYear" required>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Faculty:</label>
                                    <select id="editClassFaculty" required></select>
                                </div>
                                <div class="form-group">
                                    <label>Credits:</label>
                                    <input type="number" id="editClassCredits" value="3">
                                </div>
                            </div>
                            <button type="submit" class="btn btn-success">Update Class</button>
                        </form>
                    </div>
                </div>

                <!-- Batch Class Creator Modal -->
                <div id="batchClassModal" class="modal">
                    <div class="modal-content wide-modal">
                        <div class="modal-header">
                            Batch Class Creator
                            <button class="close-btn" onclick="closeModal('batchClassModal')">&times;</button>
                        </div>
                        <div class="alert alert-info">
                            ‚ÑπÔ∏è Paste your class list in the format: <strong>Semester, Subject Name, Subject Code,
                                Faculty
                                Name</strong>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label>Branch / Department (Applied to all):</label>
                                <select id="batchBranch" required>
                                    <option value="Computer Science">Computer Science</option>
                                    <option value="Civil">Civil</option>
                                    <option value="Mechanical">Mechanical</option>
                                    <option value="Electrical">Electrical</option>
                                    <option value="ECE">ECE</option>
                                    <option value="CSE(Cyber Security)">CSE(Cyber Security)</option>
                                    <option value="CSE(Networks)">CSE(Networks)</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Year (Applied to all):</label>
                                <input type="number" id="batchYear" value="2024">
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Paste Data (Each line is a new subject):</label>
                            <textarea id="batchClassInput" rows="6" placeholder="Example:
1, Mathematics-I, MAT101, Dr. Smith
1, Physics, PHY101, Prof. Doe"></textarea>
                        </div>

                        <button class="btn btn-primary" onclick="previewBatchClasses()">üîç Parse & Preview</button>

                        <div id="batchPreviewArea" style="display:none;">
                            <h3>Preview</h3>
                            <table id="batchPreviewTable">
                                <thead>
                                    <tr>
                                        <th>Sem</th>
                                        <th>Subject</th>
                                        <th>Code</th>
                                        <th>Faculty</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                            <div class="modal-footer">
                                <button class="btn btn-success" onclick="saveBatchClasses()">üíæ Save All
                                    Classes</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bulk Attendance Modal -->
                <div id="bulkAttendanceModal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            Bulk Upload & OCR Attendance
                            <button class="close-btn" onclick="closeModal('bulkAttendanceModal')">&times;</button>
                        </div>

                        <div class="alert alert-info">
                            <strong>Option 1:</strong> Scan a handwritten sheet. <br>
                            <strong>Option 2:</strong> Manually paste roll numbers below.
                        </div>

                        <div
                            style="background: #f8f9fa; border: 1px dashed #3498db; padding: 15px; border-radius: 6px; margin-bottom: 15px;">
                            <h4 style="margin-top: 0; color: #2c3e50;">üì∑ Smart Scan (OCR)</h4>
                            <p style="font-size: 12px; color: #666;">Take a photo of the attendance sheet. The system
                                will
                                extract roll numbers automatically.</p>

                            <input type="file" id="ocrImageInput" accept="image/*" capture="environment"
                                style="margin-bottom: 10px; width: 100%;">
                            <button class="btn btn-info btn-full" onclick="processOCR()" id="btnProcessOCR">üîç Extract
                                Registration Numbers</button>

                            <div id="ocrProgressBar"
                                style="display: none; height: 5px; background: #ddd; margin-top: 10px; border-radius: 3px; overflow: hidden;">
                                <div id="ocrProgressFill"
                                    style="height: 100%; width: 0%; background: #27ae60; transition: width 0.2s;"></div>
                            </div>
                            <div id="ocrStatus"
                                style="margin-top: 10px; font-weight: bold; font-size: 13px; text-align: center;"></div>
                        </div>

                        <div class="form-group">
                            <label>Session (for this bulk upload):</label>
                            <select id="bulkAttendanceSession">
                                <option value="1">Session 1</option>
                                <option value="2">Session 2</option>
                                <option value="3">Session 3</option>
                                <option value="4">Session 4</option>
                                <option value="5">Session 5</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Extracted / Manual Data (Edit here if needed):</label>
                            <textarea id="bulkAttendanceInput" rows="6" placeholder="22156148040, P
22156148041, P..."></textarea>
                        </div>

                        <button class="btn btn-success btn-full" onclick="saveBulkAttendance()">üíæ Upload & Save for
                            Selected
                            Session</button>
                    </div>
                </div>
                <!-- Student Attendance Detail Modal -->
                <div id="studentAttendanceDetailModal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            Student Attendance Details
                            <button class="close-btn" onclick="closeModal('studentAttendanceDetailModal')">√ó</button>
                        </div>
                        <div style="padding: 20px;">
                            <h3 id="detailStudentName">Name</h3>
                            <p><strong>Roll No:</strong> <span id="detailStudentRoll">-</span></p>
                            <p><strong>Department:</strong> <span id="detailStudentDept">-</span></p>
                            <p><strong>Semester:</strong> <span id="detailStudentSem">-</span></p>
                            <hr>
                            <h4>Attendance Records</h4>
                            <div id="detailAttendanceList" style="max-height: 400px; overflow-y: auto;"></div>
                        </div>
                    </div>
                </div>

                <!-- Add Year Modal -->
                <div id="addYearModal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            Add Academic Year
                            <button class="close-btn" onclick="closeModal('addYearModal')">&times;</button>
                        </div>
                        <form onsubmit="addAcademicYear(event)">
                            <div class="form-group">
                                <label>Year (e.g., 2024):</label>
                                <input type="number" id="academicYear" placeholder="2024" required>
                            </div>
                            <div class="form-group">
                                <label>Start Date:</label>
                                <input type="date" id="yearStartDate" required>
                            </div>
                            <div class="form-group">
                                <label>End Date:</label>
                                <input type="date" id="yearEndDate" required>
                            </div>
                            <button type="submit" class="btn btn-success">Add Year</button>
                        </form>
                    </div>
                </div>

                <!-- Edit Attendance Modal -->
                <div id="editAttendanceModal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            Edit Attendance Record
                            <button class="close-btn" onclick="closeModal('editAttendanceModal')">&times;</button>
                        </div>
                        <form onsubmit="saveEditedAttendance(event)">
                            <input type="hidden" id="editAttendanceId">
                            <input type="hidden" id="editAttendanceStudentId">

                            <div class="profile-info-grid">
                                <div class="profile-info-item">
                                    <label>Student</label>
                                    <div id="editStudentInfo">-</div>
                                </div>
                                <div class="profile-info-item">
                                    <label>Class</label>
                                    <div id="editClassInfo">-</div>
                                </div>
                                <div class="profile-info-item">
                                    <label>Date & Session</label>
                                    <div id="editDateInfo">-</div>
                                </div>
                                <div class="profile-info-item">
                                    <label>Faculty</label>
                                    <div id="editFacultyInfo">-</div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label>Session:</label>
                                <select id="editSessionSelector">
                                    <option value="1">Session 1</option>
                                    <option value="2">Session 2</option>
                                    <option value="3">Session 3</option>
                                    <option value="4">Session 4</option>
                                    <option value="5">Session 5</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label>Attendance Status:</label>
                                <div class="status-radio-group">
                                    <label>
                                        <input type="radio" name="attendanceStatus" value="present" checked>
                                        <span class="status-badge present">Present</span>
                                    </label>
                                    <label>
                                        <input type="radio" name="attendanceStatus" value="absent">
                                        <span class="status-badge absent">Absent</span>
                                    </label>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="optional-label">Notes (Optional)</label>
                                <textarea id="editAttendanceNotes" rows="3"
                                    placeholder="Add any notes about this attendance record..."></textarea>
                            </div>

                            <div class="modal-footer">
                                <button type="button" class="btn btn-danger" onclick="deleteAttendanceRecord()">üóëÔ∏è
                                    Delete
                                    Record</button>
                                <div>
                                    <button type="button" class="btn btn-secondary"
                                        onclick="closeModal('editAttendanceModal')">Cancel</button>
                                    <button type="submit" class="btn btn-success">üíæ Save Changes</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Generic Confirmation Modal -->
                <div id="confirmationModal" class="modal">
                    <div class="modal-content small-modal">
                        <div class="modal-header">
                            Confirm Action
                            <button class="close-btn" onclick="closeModal('confirmationModal')">&times;</button>
                        </div>
                        <p id="confirmationMessage">Are you sure?</p>
                        <div class="modal-footer">
                            <button class="btn btn-secondary" onclick="closeModal('confirmationModal')">Cancel</button>
                            <button class="btn btn-danger" id="confirmActionBtn">Confirm</button>
                        </div>
                    </div>
                </div>

                <!-- Password Change Modal -->
                <div id="passwordChangeModal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            üîê Change Password
                            <button class="close-btn" onclick="closeModal('passwordChangeModal')">&times;</button>
                        </div>
                        <form onsubmit="handlePasswordChange(event)">
                            <div class="form-group">
                                <label>Current Password:</label>
                                <input type="password" id="currentPassword" required>
                            </div>
                            <div class="form-group">
                                <label>New Password:</label>
                                <input type="password" id="newPassword" required minlength="6">
                            </div>
                            <div class="form-group">
                                <label>Confirm New Password:</label>
                                <input type="password" id="confirmPassword" required minlength="6">
                            </div>
                            <div class="alert alert-error" id="passwordChangeError" style="display:none;"></div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary"
                                    onclick="closeModal('passwordChangeModal')">Cancel</button>
                                <button type="submit" class="btn btn-success">Change Password</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Faculty Password Reset Modal (Admin Only) -->
                <div id="facultyPasswordResetModal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            üîë Reset Faculty Password
                            <button class="close-btn" onclick="closeModal('facultyPasswordResetModal')">&times;</button>
                        </div>
                        <div class="form-group">
                            <label>Select Faculty:</label>
                            <select id="resetFacultySelect">
                                <option value="">-- Select Faculty --</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>New Password:</label>
                            <input type="text" id="resetFacultyPassword" value="password123">
                            <small class="input-hint">Default password: password123</small>
                        </div>
                        <div class="alert alert-info" id="resetFacultyInfo" style="display: none;"></div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary"
                                onclick="closeModal('facultyPasswordResetModal')">Cancel</button>
                            <button type="button" class="btn btn-success" onclick="resetFacultyPassword()">Reset
                                Password</button>
                        </div>
                    </div>
                </div>

                <!-- Edit Student Modal -->
                <div id="editUserModal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            Edit Student
                            <button class="close-btn" onclick="closeModal('editUserModal')">&times;</button>
                        </div>
                        <form onsubmit="updateStudent(event)">
                            <input type="hidden" id="editStudentIdKey">

                            <div class="form-group">
                                <label>Roll No:</label>
                                <input type="text" id="editStudentRollNo" required>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>First Name:</label>
                                    <input type="text" id="editStudentFirstName" required>
                                </div>
                                <div class="form-group">
                                    <label>Last Name:</label>
                                    <input type="text" id="editStudentLastName" required>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Email:</label>
                                <input type="email" id="editStudentEmail" required>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Department:</label>
                                    <select id="editStudentDept" required>
                                        <option value="Computer Science">Computer Science</option>
                                        <option value="Civil">Civil</option>
                                        <option value="Mechanical">Mechanical</option>
                                        <option value="Electrical">Electrical</option>
                                        <option value="ECE">ECE</option>
                                        <option value="CSE(Cyber Security)">CSE(Cyber Security)</option>
                                        <option value="CSE(Networks)">CSE(Networks)</option>
                                        <option value="Applied Science">Applied Science</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Year:</label>
                                    <input type="number" id="editStudentYear" required>
                                </div>
                                <div class="form-group">
                                    <label>Semester:</label>
                                    <select id="editStudentSemester" required>
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                        <option value="6">6</option>
                                        <option value="7">7</option>
                                        <option value="8">8</option>
                                    </select>
                                </div>
                            </div>
                            <div class="modal-footer"
                                style="display: flex; justify-content: space-between; width: 100%;">

                                <button type="button" class="btn btn-warning"
                                    style="background-color: #f39c12; color: white; border: none; padding: 8px 15px; border-radius: 4px; cursor: pointer;"
                                    onclick="adminResetStudentPassword(document.getElementById('editStudentRollNo').value)">
                                    üîë Reset & Email Password
                                </button>

                                <button type="submit" class="btn btn-success">üíæ Save Changes</button>
                            </div>
                        </form>
                    </div>
                </div>
                <!-- Toast Container -->
                <div class="toast-container" id="toastContainer"></div>

                <!-- ================ EXTERNAL JAVASCRIPT FILES ================ -->
                <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
                <script src="https://cdn.jsdelivr.net/npm/tesseract.js@4/dist/tesseract.min.js"></script>
                <script src="js/config.js"></script>
                <script src="js/database.js"></script>
                <script src="js/import.js"></script>
                <script src="js/export.js"></script>
                <script src="js/auth.js"></script>
                <script src="js/ui.js"></script>
                <script src="js/attendance.js"></script>
                <script src="js/utils.js"></script>
                <script src="js/main.js"></script>
                <script src="js/marks.js"></script>
</body>

</html>
